kind: pipeline
type: docker
name: Testing Python CI/CD


steps:
#- name: Black Code Format Check
#  image: deadtree101/netauto
#  commands:
#  - black . --check
- name: check-python-packages
  image: deadtree101/netauto
  commands:
  - python -m pip list

#- name: debug-batfish-connection
#  image: deadtree101/netauto:latest
#  commands:
#  - curl -v http://127.0.0.1:9996/v2/version || echo "Connection to localhost failed"
#  - curl -v http://host.docker.internal:9996/v2/version || echo "Connection to host.docker.internal failed"
#  - curl -v http://172.17.0.1:9996/v2/version || echo "Connection to Docker host IP failed"
      
- name: Batfish Prechecks
  image: deadtree101/netauto
  commands:
  - python batfish_updated.py

- name: Check IP Interfaces
  image: deadtree101/netauto
#  environment:
#    MY_PASS:
#      from_secret: MY_PASS
  commands:
# - pip3 install -r requirements.txt
  - python3 checkip.py

trigger:
  branch:
    exclude:
    - master
